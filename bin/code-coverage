#!/usr/bin/env php
<?php

$possibleAutoloadPaths = [
    join(DIRECTORY_SEPARATOR, [__DIR__, '..', 'autoload.php']),
    join(DIRECTORY_SEPARATOR, [__DIR__, '..', 'vendor', 'autoload.php'])
];

foreach ($possibleAutoloadPaths as $autoloadPath) {
    if (file_exists($autoloadPath)) {
        require_once realpath($autoloadPath);
        break;
    }
}

use G4\CodeCoverage\Runner;
use Garden\Cli\Cli;

$cli = new Cli();

$cli->description('Analyze phpunit coverage report.')
    ->opt('file:f', 'Path to phpunit\'s code coverage xml report', true, 'string')
    ->opt('percentage:p', 'Minimum coverage percentage to be considered "highly" covered.', true, 'integer');

$args = $cli->parse($argv, true);

(new Runner($args))->run();